---
const navItems = [
  {
    name: "About",
    url: "/",
    icons: "fa-solid fa-user",
  },
  {
    name: "Contact",
    url: "/contact",
    icons: "fa-solid fa-envelope",
  },
  {
    name: "GitHub",
    url: "https://github.com/badger3000",
    icons: "fa-brands fa-github",
  },
  {
    name: "LinkedIn",
    url: "https://www.linkedin.com/in/kyle-r-ross",
    icons: "fa-brands fa-linkedin",
  },
];
---

<ul class="nav-items">
  {
    navItems.map((item) => (
      <li class="nav-item mb-6">
        <a
          href={item.url}
          class="nav-link active block align-middle text-2xl transition-all duration-1000 ease-in-out after:mt-[3px] after:block after:h-[2px] after:w-0 after:bg-white after:transition-all after:duration-300 after:ease-in-out lg:text-lg lg:hover:after:w-full"
        >
          <>
            <i class={item.icons + " nav-icon mr-2.5"} />
            <span>{item.name}</span>
          </>
        </a>
      </li>
    ))
  }
</ul>
<button
  class="button group relative z-20 block lg:hidden"
  aria-label="Toggle Menu"
>
  <div
    class="relative flex h-12 w-12 transform items-center justify-center overflow-hidden transition-all duration-200"
  >
    <div
      class="flex h-5 w-5 origin-center transform flex-col justify-between overflow-hidden transition-all duration-300"
    >
      <div
        class="top-bar h-0.5 w-7 origin-left transform bg-white transition-all duration-300"
      >
      </div>
      <div
        class="middle-bar h-0.5 w-1/2 transform rounded bg-white transition-all duration-300"
      >
      </div>
      <div
        class="bottom-bar h-0.5 w-7 origin-left transform bg-white transition-all duration-300"
      >
      </div>
    </div>
  </div>
</button>
<script is:inline>
  function handleMenuToggle(event) {
    const button = event.target.closest("button[aria-label='Toggle Menu']");
    if (button) {
      const navItems = document.querySelector("ul.nav-items");
      const body = document.body;
      const bars = document.querySelectorAll(
        ".top-bar, .middle-bar, .bottom-bar"
      );

      if (navItems && bars.length) {
        navItems.classList.toggle("mobile-menu");
        body.classList.toggle("overflow-hidden");
        bars.forEach((bar) => bar.classList.toggle("animate"));
      }
    }
  }

  function setupMobileMenu() {
    document.removeEventListener("click", handleMenuToggle);
    document.addEventListener("click", handleMenuToggle);
    console.log("Mobile menu setup complete");
  }

  // Initial setup
  setupMobileMenu();

  // Setup for subsequent navigations
  document.addEventListener("astro:after-swap", setupMobileMenu);

  // Cleanup before navigation
  document.addEventListener("astro:before-swap", () => {
    document.removeEventListener("click", handleMenuToggle);
    console.log("Mobile menu cleanup complete");
  });
</script>
<style>
  ul.nav-items {
    @apply opacity-0 hidden fixed left-0 top-0 z-10 h-screen w-screen overflow-auto bg-zinc-900 pt-[20%] text-center transition-opacity duration-200 ease-in-out md:hidden lg:relative lg:block lg:h-auto lg:min-h-full lg:w-auto lg:bg-transparent lg:text-left lg:opacity-100;
  }
  ul.nav-items.mobile-menu {
    @apply opacity-100 block !important;
  }
  .nav-link.active {
    @apply lg:after:w-full;
  }

  .top-bar.animate {
    @apply group-focus:rotate-[42deg];
  }

  .middle-bar.animate {
    @apply group-focus:-translate-x-10;
  }
  .bottom-bar.animate {
    @apply group-focus:-rotate-[42deg];
  }
</style>
